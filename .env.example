# Vibe Kanban Environment Configuration
# Copy this file to .env and modify as needed

# =============================================================================
# Network Configuration (Local Development)
# =============================================================================

# Backend host binding
# - Use 127.0.0.1 for localhost only (default)
# - Use 0.0.0.0 for network access from other machines
# HOST=127.0.0.1

# Frontend port (default: 3000)
# FRONTEND_PORT=3000

# Backend port (default: 0 for auto-assign, or specify like 3001)
# BACKEND_PORT=3001

# Alternative: Set PORT to configure both (frontend=PORT, backend=PORT+1)
# PORT=3000

# Direct backend URL override for MCP server (optional, auto-derived if not set)
# VIBE_BACKEND_URL=http://localhost:3001

# MCP server HTTP port (optional)
# If set, backend auto-spawns an HTTP MCP server at http://{HOST}:{MCP_PORT}/mcp
# Allows executors to connect to a locally running MCP server
# MCP_PORT=3002

# =============================================================================
# Logging
# =============================================================================

# Log level: trace, debug, info, warn, error
# RUST_LOG=info

# =============================================================================
# Storage Configuration (Optional)
# =============================================================================
# Override default storage locations. Supports tilde expansion (e.g., ~/vibe-kanban/db.sqlite).
# See docs/configuration-customisation/storage-configuration for full guide.

# Database file path (default: platform-specific data directory)
# - Development: <project_root>/dev_assets/db.sqlite
# - Production: ~/.local/share/vibe-kanban/db.sqlite (Linux)
# VK_DATABASE_PATH=/custom/path/to/db.sqlite

# Backup storage directory (default: {data_dir}/backups)
# VK_BACKUP_DIR=/custom/backups

# Worktree storage directory (default: /var/tmp/vibe-kanban/worktrees)
# VK_WORKTREE_DIR=/custom/worktrees

# =============================================================================
# Database & Performance Configuration
# =============================================================================
# See docs/configuration-customisation/database-performance for full guide.

# SQLite connection pool size (default: 10)
# Reduce if experiencing lock contention, increase for high concurrency
# VK_SQLITE_MAX_CONNECTIONS=10

# Slow query threshold in milliseconds (default: 100)
# Queries exceeding this are logged and tracked in metrics
# VK_SLOW_QUERY_MS=100

# =============================================================================
# Scheduled Backups Configuration
# =============================================================================

# Enable automatic scheduled backups (default: true)
# Set to "false" or "0" to disable
# VK_SCHEDULED_BACKUPS=true

# Backup interval in hours (default: 4)
# Set to 0 to disable scheduled backups
# VK_BACKUP_INTERVAL_HOURS=4

# Number of backups to retain (default: 5 pre-migration, 10 scheduled)
# Format options:
#   VK_BACKUP_RETENTION=10       - sets both to 10
#   VK_BACKUP_RETENTION=5,10     - sets pre-migration to 5, scheduled to 10
# VK_BACKUP_RETENTION=5,10

# =============================================================================
# File Logging (Optional)
# =============================================================================

# Enable file-based debug logging (default: false)
# Logs written to dev_assets/logs/ with daily rotation (JSON format)
# VK_FILE_LOGGING=false

# Log file directory (default: dev_assets/logs)
# VK_LOG_DIR=./dev_assets/logs

# Number of daily log files to retain (default: 7)
# VK_LOG_MAX_FILES=7

# =============================================================================
# WAL Monitoring Configuration
# =============================================================================

# How often to check WAL file size in seconds (default: 60)
# VK_WAL_CHECK_INTERVAL_SECS=60

# WAL size in MB that triggers a warning log (default: 50)
# VK_WAL_WARNING_THRESHOLD_MB=50

# WAL size in MB that triggers automatic passive checkpoint (default: 100)
# VK_WAL_CHECKPOINT_THRESHOLD_MB=100

# Enable automatic passive checkpoints when threshold exceeded (default: true)
# VK_WAL_AUTO_CHECKPOINT=true

# Interval in seconds for forced TRUNCATE checkpoint (default: 300 / 5 minutes)
# TRUNCATE checkpoint flushes all WAL to main database file, ensuring data
# durability in case of abrupt server termination. Set to 0 to disable.
# VK_WAL_TRUNCATE_INTERVAL_SECS=300

# =============================================================================
# Remote Server Connection (Optional)
# =============================================================================

# URL of the remote sync server (crates/remote)
# Set this to connect to a shared task synchronization server
# Can be set at build time or runtime
# VK_SHARED_API_BASE=http://localhost:3000

# =============================================================================
# Swarm/Hive Node Configuration (Optional)
# =============================================================================
# Configure this instance to connect to a central hive server as a node.
# See docs/swarm-hive-setup.mdx for the full setup guide.

# WebSocket URL of the hive server (required to enable swarm mode)
# VK_HIVE_URL=wss://hive.example.com

# API key for authenticating with the hive (required)
# Generate this from the hive's API: POST /v1/nodes/api-keys
# VK_NODE_API_KEY=vk_xxxxxxxxxxxxx

# Human-readable name for this node (optional, defaults to hostname)
# VK_NODE_NAME=My Development Machine

# Public URL where this node can be reached for direct log streaming (optional)
# If set, the hive frontend can connect directly to this node for lower latency
# Requires HOST=0.0.0.0 to be accessible from other machines
# VK_NODE_PUBLIC_URL=http://192.168.1.50:3000

# JWT secret for validating direct connection tokens (optional)
# Must match the hive's VIBEKANBAN_REMOTE_JWT_SECRET for direct log streaming
# VK_CONNECTION_TOKEN_SECRET=your_base64_encoded_secret

# =============================================================================
# Authentication
# =============================================================================

# OAuth credentials storage backend (macOS only)
# Values: keychain (default in release), file (default in debug)
# OAUTH_CREDENTIALS_BACKEND=keychain

# =============================================================================
# Worktree Cleanup Configuration
# =============================================================================

# Disable cleanup of orphaned worktrees (worktrees without matching task attempts)
# Set to "1" or "true" to disable (default: cleanup enabled)
# DISABLE_WORKTREE_ORPHAN_CLEANUP=0

# Disable cleanup of expired worktrees (worktrees idle for 72+ hours)
# Set to "1" or "true" to disable (default: cleanup enabled)
# DISABLE_WORKTREE_EXPIRED_CLEANUP=0

# =============================================================================
# Debug Options
# =============================================================================

# Enable debug output in CLI
# VIBE_KANBAN_DEBUG=1

# =============================================================================
# Frontend Development (Vite)
# =============================================================================

# Auto-open browser on dev server start
# VITE_OPEN=true

# Enable i18n linting rules in ESLint
# LINT_I18N=true

# Allow embedding in iframe from specific origin
# VITE_PARENT_ORIGIN=https://example.com

# =============================================================================
# Remote Server Configuration (crates/remote - for self-hosting)
# =============================================================================
# These variables are only relevant when running the remote sync server.

# PostgreSQL connection pool size (default: 10)
# VK_PG_MAX_CONNECTIONS=10

# Email service API key for notifications (optional)
# LOOPS_EMAIL_API_KEY=your_api_key

# Build-time variables for version tracking (automatically set during build)
# VK_GIT_COMMIT=<auto>
# VK_GIT_BRANCH=<auto>
