---
name: Add transaction-safe Task model function for clearing shared_task_id
status: completed
created: 2026-01-16T02:45:11Z
updated: 2026-01-16T09:44:00Z
depends_on: []
conflicts_with: []
---

# Task: Add transaction-safe Task model function for clearing shared_task_id

## Description
Add a `_tx` variant of the function to clear shared_task_id values that accepts an executor trait, enabling it to participate in database transactions.

## Acceptance Criteria
- [x] Function `clear_all_shared_task_ids_for_project_tx` added to Task model
- [x] Function accepts generic Executor trait bound to Sqlite database
- [x] Function clears shared_task_id for all tasks in a project
- [x] Returns Result with rows_affected count
- [x] Function follows existing _tx pattern in codebase
- [x] Compiles without errors
- [x] Clippy passes

## Technical Details
- Location: `crates/db/src/models/task/sync.rs`
- Use `sqlx::Executor` trait with lifetime bounds
- SQL: `UPDATE tasks SET shared_task_id = NULL WHERE project_id = $1 AND shared_task_id IS NOT NULL`
- Return type: `Result<u64, sqlx::Error>`

## Dependencies
- None

## Effort Estimate
- Size: XS
- Hours: 0.25

## Definition of Done
- [x] Function implemented per specification
- [x] Compiles without errors
- [x] Clippy passes with -D warnings
- [x] Code committed with descriptive message
