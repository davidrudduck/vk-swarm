---
name: Add transaction-safe TaskAttempt model function for clearing hive_synced_at
status: open
created: 2026-01-16T02:45:11Z
updated: 2026-01-16T02:45:11Z
depends_on: []
conflicts_with: []
---

# Task: Add transaction-safe TaskAttempt model function for clearing hive_synced_at

## Description
Add a `_tx` variant of the function to clear hive_synced_at values that accepts an executor trait, enabling it to participate in database transactions.

## Acceptance Criteria
- [x] Function `clear_hive_sync_for_project_tx` added to TaskAttempt model
- [x] Function accepts generic Executor trait bound to Sqlite database
- [x] Function clears hive_synced_at for all task attempts in a project
- [x] Uses JOIN to filter by project_id from tasks table
- [x] Returns Result with rows_affected count
- [x] Function follows existing _tx pattern in codebase
- [x] Compiles without errors (pending SQLX cache update from rebase)
- [x] Clippy passes (pending SQLX cache update from rebase)

## Technical Details
- Location: `crates/db/src/models/task_attempt.rs`
- Use `sqlx::Executor` trait with lifetime bounds
- SQL with JOIN: `UPDATE task_attempts SET hive_synced_at = NULL FROM tasks WHERE task_attempts.task_id = tasks.id AND tasks.project_id = $1`
- Return type: `Result<u64, sqlx::Error>`

## Dependencies
- None

## Effort Estimate
- Size: XS
- Hours: 0.25

## Definition of Done
- [x] Function implemented per specification
- [x] Compiles without errors (pending SQLX cache)
- [x] Clippy passes with -D warnings (pending SQLX cache)
- [x] Code committed with descriptive message
