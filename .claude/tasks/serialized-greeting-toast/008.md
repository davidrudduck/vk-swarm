---
name: Write test case for failed injection keeps message in queue
status: done
created: 2026-01-11T11:25:01Z
updated: 2026-01-12T09:12:00Z
depends_on: [006]
conflicts_with: []
---

# Task: Write test case for failed injection keeps message in queue

## Description
Write a test case that verifies messages stay in the queue when injection fails.

## Acceptance Criteria
- [x] Test verifies messageQueueApi.remove is NOT called when injection fails
- [x] Test verifies response is { queued: true, injected: false }
- [x] Mocks return appropriate values for failure scenario
- [x] Test passes

## Technical Details
- Mock messageQueueApi.add to return message object
- Mock executionProcessesApi.injectMessage to return { injected: false }
- Verify messageQueueApi.remove was NOT called

## Dependencies
- Task 006 (test file setup)

## Effort Estimate
- Size: XS
- Hours: 0.25

## Definition of Done
- [x] Test written
- [x] Test passes

## Completion Notes
Test already exists at `frontend/src/hooks/message-queue/__tests__/useMessageQueueInjection.test.ts` lines 94-124.
The test "keeps message in queue when injection returns false" verifies all acceptance criteria:
- Line 122: `expect(response!).toEqual({ queued: true, injected: false });`
- Line 123: `expect(mockMessageQueueApi.remove).not.toHaveBeenCalled();`
- Lines 103-106: Mock returns `{ injected: false }`
- All 12 tests pass
