---
name: Fix Font Size and Pencil Icon Visibility
status: open
created: 2026-01-20T11:25:43Z
updated: 2026-01-20T11:25:43Z
depends_on: []
conflicts_with: []
model_hint: simple
estimated_minutes: 15
---

# Task: Fix Font Size and Pencil Icon Visibility

## Description
Fix two visual consistency issues in the UserMessage component:
1. User messages currently don't have consistent font size with other messages
2. Edit pencil icon is not visible on hover due to incorrect `group` class placement

## Acceptance Criteria
- [ ] User messages render at same font size (12px / text-sm) as other message types
- [ ] Edit pencil icon becomes visible when hovering over the message
- [ ] All tests pass
- [ ] No TypeScript errors

## Technical Details
The issue is caused by:
1. Missing `text-sm` class on the content wrapper
2. The `group` class is on the wrong element (content div instead of outer container)

**Current structure (incorrect):**
```tsx
<div className="border w-full overflow-hidden rounded-sm">  {/* No group here */}
  <div className="px-3 py-2 group">  {/* group is here - wrong! */}
    {/* content */}
  </div>
</div>
```

**Fixed structure:**
```tsx
<div className="border w-full overflow-hidden rounded-sm group">  {/* group moved here */}
  <div className="px-3 py-2 text-sm">  {/* text-sm added, group removed */}
    {/* content */}
  </div>
</div>
```

## Dependencies
None - this is a standalone CSS class change

## Steps

### Step 1: Write failing test for font size consistency
**File**: `frontend/src/components/NormalizedConversation/__tests__/UserMessage.test.tsx`

Add this test to the file:
```typescript
describe('styling consistency', () => {
  it('renders content with text-sm class for font size consistency', () => {
    const { container } = render(<UserMessage content="Test message" />);
    const contentDiv = container.querySelector('.text-sm');
    expect(contentDiv).toBeInTheDocument();
  });
});
```

### Step 2: Write failing test for edit button hover visibility
**File**: `frontend/src/components/NormalizedConversation/__tests__/UserMessage.test.tsx`

Add this test to the file:
```typescript
describe('edit button visibility', () => {
  it('has group class on outer container for hover effects', () => {
    const mockTaskAttempt = { id: 'test', executor: 'CLAUDE_CODE' };
    const { container } = render(
      <UserMessage
        content="Test"
        executionProcessId="exec-1"
        taskAttempt={mockTaskAttempt as TaskAttempt}
      />
    );
    const outerContainer = container.querySelector('.group.border');
    expect(outerContainer).toBeInTheDocument();
  });
});
```

### Step 3: Add text-sm class to content wrapper
**File**: `frontend/src/components/NormalizedConversation/UserMessage.tsx`
**Location**: Around line 151

Find the line:
```typescript
<div className={cn('px-3 py-2 group', USER_MESSAGE_APPEARANCE.contentBg)}>
```

Change to:
```typescript
<div className={cn('px-3 py-2 text-sm', USER_MESSAGE_APPEARANCE.contentBg)}>
```

### Step 4: Add group class to outer container
**File**: `frontend/src/components/NormalizedConversation/UserMessage.tsx`
**Location**: Around line 109

Find the line:
```typescript
<div className={cn('border w-full overflow-hidden rounded-sm', USER_MESSAGE_APPEARANCE.border)}>
```

Change to:
```typescript
<div className={cn('border w-full overflow-hidden rounded-sm group', USER_MESSAGE_APPEARANCE.border)}>
```

### Step 5: Run tests to verify fixes
```bash
cd frontend
npm run test -- UserMessage.test.tsx
```

All tests should pass.

## Files to Modify
- `frontend/src/components/NormalizedConversation/UserMessage.tsx` - Move group class, add text-sm
- `frontend/src/components/NormalizedConversation/__tests__/UserMessage.test.tsx` - Add 2 new tests

## Validation
- [ ] Run `cd frontend && npm run test -- UserMessage.test.tsx`
- [ ] Run `cd frontend && npx tsc --noEmit` to check TypeScript
- [ ] Visually verify in browser that font size matches other messages
- [ ] Visually verify pencil icon appears on hover

## Commit
```bash
fix: improve UserMessage font size and hover visibility

- Add text-sm class for 12px font consistency
- Move group class to outer container for proper hover effects
- Add tests for styling consistency
```

## Notes
- This is a CSS-only change, no logic changes required
- The `group` class from Tailwind enables the `group-hover:` utilities to work on child elements
- The `text-sm` class sets font-size to 12px (0.875rem)
