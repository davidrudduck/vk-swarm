---
name: Wire ExecutionProcess to DisplayConversationEntry
status: open
created: 2026-01-20T22:56:20Z
updated: 2026-01-20T22:56:20Z
depends_on: []
conflicts_with: []
model_hint: moderate
estimated_minutes: 30
---

# Task: Wire ExecutionProcess to DisplayConversationEntry

## Description
Make ExecutionProcess data available to DisplayConversationEntry component by using the ExecutionProcessesContext to look up the execution process by ID.

## Acceptance Criteria
- [ ] DisplayConversationEntry uses ExecutionProcessesContext to fetch ExecutionProcess
- [ ] getExecutorVariant function is called with the ExecutionProcess data
- [ ] @ts-ignore comment is removed
- [ ] executorVariant is properly passed to UserMessage
- [ ] TypeScript compiles without errors

## Technical Details
The VirtualizedList component already passes `executionProcessId` to DisplayConversationEntry. We need to use the ExecutionProcessesContext hook to look up the full ExecutionProcess object by ID, then pass it to the getExecutorVariant function.

The ExecutionProcessesContext provides `executionProcessesByIdAll` which is a Record<string, ExecutionProcess> that can be used to look up processes by ID.

## Dependencies
- ExecutionProcessesContext is already available in the codebase
- getExecutorVariant function is already defined (lines 70-77 in DisplayConversationEntry.tsx)

## Steps

### Step 1: Import useExecutionProcesses hook
**File**: `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`

Add to the imports at the top of the file (around line 41):
```typescript
import { useExecutionProcesses } from '@/contexts/ExecutionProcessesContext';
```

### Step 2: Use the hook to get ExecutionProcess by ID
**File**: `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`

Find the function definition starting at line 78. Add this code after the Props destructuring and before the useExpandable hook (around line 80):

```typescript
function DisplayConversationEntry({
  entry,
  expansionKey,
  executionProcessId,
  taskAttempt,
  task,
}: Props) {
  // ADD THIS LINE:
  const { executionProcessesByIdAll } = useExecutionProcesses();

  // Existing code continues...
  const [isOpen, setIsOpen] = useExpandable(
```

### Step 3: Look up ExecutionProcess and call getExecutorVariant
**File**: `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`

Find line 842 where it says `executorVariant={null}`. Replace it with:

```typescript
executorVariant={getExecutorVariant(
  executionProcessId ? executionProcessesByIdAll[executionProcessId] : undefined
)}
```

### Step 4: Remove @ts-ignore comment
**File**: `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`

Delete line 69:
```typescript
// @ts-ignore - Function prepared for future use when ExecutionProcess data is available
```

The JSDoc comment above it (lines 62-68) should remain.

## Files to Modify
- `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`
  - Add import for useExecutionProcesses (line ~41)
  - Add hook usage in component (line ~80)
  - Update executorVariant prop to use getExecutorVariant (line 842)
  - Remove @ts-ignore comment (line 69)

## Code

### Import Addition (after line 34)
```typescript
import { useExecutionProcesses } from '@/contexts/ExecutionProcessesContext';
```

### Hook Usage (after line 78, inside function)
```typescript
const { executionProcessesByIdAll } = useExecutionProcesses();
```

### Updated executorVariant call (line 842)
```typescript
executorVariant={getExecutorVariant(
  executionProcessId ? executionProcessesByIdAll[executionProcessId] : undefined
)}
```

## Validation
- [ ] No TypeScript errors: `cd frontend && npx tsc --noEmit`
- [ ] Code compiles successfully
- [ ] getExecutorVariant is being called with actual data
- [ ] No @ts-ignore comments remain

## Commit
```bash
fix: wire up executor variant display in DisplayConversationEntry

- Use ExecutionProcessesContext to fetch ExecutionProcess by ID
- Call getExecutorVariant with actual ExecutionProcess data
- Remove @ts-ignore workaround comment
```

## Notes
- The getExecutorVariant function is already implemented and handles cases where ExecutionProcess is undefined
- ExecutionProcessesContext must be available in the component tree (it's provided by ExecutionProcessesProvider in the parent components)
- This change makes the variant visible in user messages when the execution process has variant data
