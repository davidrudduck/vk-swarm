---
name: Create stop_script migration
status: open
created: 2026-01-19T12:00:00Z
updated: 2026-01-19T12:00:00Z
depends_on: []
conflicts_with: []
model_hint: simple
estimated_minutes: 15
---

# Task: Create stop_script migration

## Goal
Add `stop_script` column to projects table.

## Context
Projects need a `stop_script` field for graceful dev server shutdown. This is similar to `setup_script`, `dev_script`, and `cleanup_script` that already exist.

Migrations are in `crates/db/migrations/` and are SQL files with timestamps in the filename.

## Steps
1. Create a new migration file with the current timestamp
2. Add ALTER TABLE statement to add the column

## Files to Create
- `crates/db/migrations/20260119120000_add_stop_script_to_projects.sql` (adjust timestamp as needed)

## Code

Create the migration file with this content:

```sql
-- Add stop_script field for graceful dev server shutdown

ALTER TABLE projects ADD COLUMN stop_script TEXT;
```

### Filename format

The filename should be: `YYYYMMDDHHMMSS_description.sql`

Use the current date/time for the timestamp. For example:
- `20260119120000_add_stop_script_to_projects.sql`

You can check existing migrations to see the naming pattern:
```bash
ls crates/db/migrations/
```

## Verification
- [ ] Migration file exists with correct format
- [ ] File contains valid SQL ALTER TABLE statement
- [ ] Run `cargo sqlx prepare --workspace` to update sqlx-data.json (if used)

## Commit
`feat(db): add stop_script column to projects`

## Notes
- The column is nullable (`TEXT` without `NOT NULL`) like the other script fields
- SQLite's ALTER TABLE ADD COLUMN only allows adding nullable columns or columns with defaults
- The migration will run automatically on next server startup
- Existing projects will have `stop_script = NULL` after migration
