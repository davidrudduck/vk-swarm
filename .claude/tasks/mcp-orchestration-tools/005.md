---
name: Add frontend templates API methods
status: open
created: 2026-01-19T12:00:00Z
updated: 2026-01-19T12:00:00Z
depends_on: ["003", "004"]
conflicts_with: []
model_hint: simple
estimated_minutes: 15
---

# Task: Add frontend templates API methods

## Goal
Add `listAll()` and `getByName()` methods to the frontend templates API.

## Context
The frontend needs API methods to call the new backend endpoints:
- `GET /api/templates/all` - returns all templates from all sources
- `GET /api/templates/by-name/{name}` - returns a single template by name

The templates API is in `frontend/src/lib/api/templates.ts`.

**IMPORTANT**: Before doing this task, you MUST run `npm run generate-types` from the project root to generate the `UnifiedTemplate` TypeScript type from the Rust struct added in Task 001.

**Current file structure**:
```typescript
import { Template, TemplateSearchParams, CreateTemplate, UpdateTemplate } from 'shared/types';
import { makeRequest, handleApiResponse } from './utils';

export const templatesApi = {
  list: async (params?: TemplateSearchParams): Promise<Template[]> => {...},
  create: async (data: CreateTemplate): Promise<Template> => {...},
  update: async (templateId: string, data: UpdateTemplate): Promise<Template> => {...},
  delete: async (templateId: string): Promise<void> => {...},
};
```

## Steps
1. Run `npm run generate-types` to generate `UnifiedTemplate` type
2. Add `UnifiedTemplate` to the imports
3. Add `listAll` method after `list`
4. Add `getByName` method after `listAll`

## Files to Modify
- `frontend/src/lib/api/templates.ts` - Update imports (line 4-10), add two methods

## Code

### Step 1: Update imports

Change:
```typescript
import {
  Template,
  TemplateSearchParams,
  CreateTemplate,
  UpdateTemplate,
} from 'shared/types';
```

To:
```typescript
import {
  Template,
  TemplateSearchParams,
  CreateTemplate,
  UpdateTemplate,
  UnifiedTemplate,
} from 'shared/types';
```

### Step 2: Add methods to templatesApi object

Add these methods after `list` and before `create`:

```typescript
  /**
   * List all templates from all sources (system + swarm + local)
   */
  listAll: async (): Promise<UnifiedTemplate[]> => {
    const response = await makeRequest('/api/templates/all');
    return handleApiResponse<UnifiedTemplate[]>(response);
  },

  /**
   * Get a template by name (searches system -> swarm -> local)
   */
  getByName: async (name: string, taskId?: string): Promise<UnifiedTemplate> => {
    const queryParam = taskId ? `?task_id=${encodeURIComponent(taskId)}` : '';
    const response = await makeRequest(
      `/api/templates/by-name/${encodeURIComponent(name)}${queryParam}`
    );
    return handleApiResponse<UnifiedTemplate>(response);
  },
```

### Complete file should look like:

```typescript
/**
 * Templates API - Template management for @mentions in descriptions.
 */

import {
  Template,
  TemplateSearchParams,
  CreateTemplate,
  UpdateTemplate,
  UnifiedTemplate,
} from 'shared/types';

import { makeRequest, handleApiResponse } from './utils';

/**
 * Templates API namespace - Used for @mentions in descriptions.
 */
export const templatesApi = {
  list: async (params?: TemplateSearchParams): Promise<Template[]> => {
    const queryParam = params?.search
      ? `?search=${encodeURIComponent(params.search)}`
      : '';
    const response = await makeRequest(`/api/templates${queryParam}`);
    return handleApiResponse<Template[]>(response);
  },

  /**
   * List all templates from all sources (system + swarm + local)
   */
  listAll: async (): Promise<UnifiedTemplate[]> => {
    const response = await makeRequest('/api/templates/all');
    return handleApiResponse<UnifiedTemplate[]>(response);
  },

  /**
   * Get a template by name (searches system -> swarm -> local)
   */
  getByName: async (name: string, taskId?: string): Promise<UnifiedTemplate> => {
    const queryParam = taskId ? `?task_id=${encodeURIComponent(taskId)}` : '';
    const response = await makeRequest(
      `/api/templates/by-name/${encodeURIComponent(name)}${queryParam}`
    );
    return handleApiResponse<UnifiedTemplate>(response);
  },

  create: async (data: CreateTemplate): Promise<Template> => {
    const response = await makeRequest('/api/templates', {
      method: 'POST',
      body: JSON.stringify(data),
    });
    return handleApiResponse<Template>(response);
  },

  update: async (
    templateId: string,
    data: UpdateTemplate
  ): Promise<Template> => {
    const response = await makeRequest(`/api/templates/${templateId}`, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
    return handleApiResponse<Template>(response);
  },

  delete: async (templateId: string): Promise<void> => {
    const response = await makeRequest(`/api/templates/${templateId}`, {
      method: 'DELETE',
    });
    return handleApiResponse<void>(response);
  },
};
```

## Verification
- [ ] Run `npm run generate-types` first (if not already done)
- [ ] Run `cd frontend && npx tsc --noEmit` - should succeed with no errors
- [ ] `UnifiedTemplate` type exists in `shared/types.ts`

## Commit
`feat(frontend): add listAll and getByName to templates API`

## Notes
- The `UnifiedTemplate` type is auto-generated from Rust via `npm run generate-types`
- The `taskId` parameter in `getByName` is optional and used for future swarm context
- URL encoding is used for the template name to handle special characters
- Both methods use the existing `makeRequest` and `handleApiResponse` utilities
