---
name: Add UnifiedTemplate type to db models
status: open
created: 2026-01-19T12:00:00Z
updated: 2026-01-19T12:00:00Z
depends_on: []
conflicts_with: []
model_hint: simple
estimated_minutes: 15
---

# Task: Add UnifiedTemplate type to db models

## Goal
Define the `UnifiedTemplate` response struct with source field for template unification.

## Context
The project is adding a unified templates API that combines templates from three sources: system (hardcoded), swarm (from Hive), and local (SQLite database). This task adds the Rust type that will represent templates from any source.

The existing `Template` type in `crates/db/src/models/template.rs` represents local database templates. We need a new `UnifiedTemplate` type that includes a `source` field to indicate where the template came from.

**Project conventions:**
- Use `#[derive(Debug, Clone, Serialize, Deserialize, TS)]` for response types
- Add `#[ts(export)]` to generate TypeScript types
- Use `#[ts(type = "Date | null")]` for optional DateTime fields

## Steps
1. Open `crates/db/src/models/template.rs`
2. Add the `UnifiedTemplate` struct after the existing `UpdateTemplate` struct (around line 26)
3. The struct needs:
   - `id: String` (not Uuid since system templates use string IDs like "system-bug-report")
   - `name: String`
   - `content: String`
   - `description: Option<String>`
   - `source: String` ("system", "swarm", or "local")
   - `created_at: Option<DateTime<Utc>>`
   - `updated_at: Option<DateTime<Utc>>`

## Files to Modify
- `crates/db/src/models/template.rs` - Add `UnifiedTemplate` struct after line 26

## Code

Add this struct after `UpdateTemplate` (after line 26):

```rust
/// Unified template combining system, swarm, and local sources
#[derive(Debug, Clone, Serialize, Deserialize, TS)]
#[ts(export)]
pub struct UnifiedTemplate {
    pub id: String,
    pub name: String,
    pub content: String,
    pub description: Option<String>,
    /// Source of the template: "system", "swarm", or "local"
    pub source: String,
    #[ts(type = "Date | null")]
    pub created_at: Option<DateTime<Utc>>,
    #[ts(type = "Date | null")]
    pub updated_at: Option<DateTime<Utc>>,
}
```

## Verification
- [ ] Run `cargo check -p db` - should succeed with no errors
- [ ] No duplicate struct definitions
- [ ] The struct has all required fields: id, name, content, description, source, created_at, updated_at

## Commit
`feat(db): add UnifiedTemplate type for template unification`

## Notes
- The `id` field is `String` not `Uuid` because system templates use string IDs like "system-bug-report"
- The `ts_rs::TS` derive is already imported at the top of the file (line 4)
- `chrono::DateTime` and `chrono::Utc` are already imported (line 1)
