---
name: Add environment variables to OpenCode executor
status: completed
created: 2026-01-23T08:42:27Z
updated: 2026-01-23T11:15:00Z
depends_on: [001]
parallel: true
conflicts_with: []
---

# Task: Add environment variables to OpenCode executor

## Description
Update the OpenCode executor's spawn implementation to inject VK_ATTEMPT_ID, VK_TASK_ID, and VK_EXECUTION_PROCESS_ID environment variables into the spawned process.

## Acceptance Criteria
- [x] OpenCode executor's spawn method accepts SpawnContext parameter
- [x] VK_ATTEMPT_ID env var set to context.task_attempt_id.to_string()
- [x] VK_TASK_ID env var set to context.task_id.to_string()
- [x] VK_EXECUTION_PROCESS_ID env var set to context.execution_process_id.to_string()
- [x] Code compiles without errors (OpenCode-specific errors resolved)

## Technical Details
**File**: `crates/executors/src/executors/opencode.rs`

Update the `spawn` method implementation to:
1. Accept the `SpawnContext` parameter (updating trait implementation)
2. Add environment variables to the Command before spawning:

```rust
cmd.env("VK_ATTEMPT_ID", context.task_attempt_id.to_string())
   .env("VK_TASK_ID", context.task_id.to_string())
   .env("VK_EXECUTION_PROCESS_ID", context.execution_process_id.to_string())
```

## Dependencies
- [x] Task 001 must be completed (SpawnContext struct exists)

## Effort Estimate
- Size: XS
- Hours: 0.5
- Parallel: true (can be done alongside other executor updates)

## Definition of Done
- [x] Trait implementation signature updated
- [x] Environment variables added to Command
- [x] Code compiles without errors (OpenCode-specific)
- [x] Changes committed to git (commit: 1364437ae)
