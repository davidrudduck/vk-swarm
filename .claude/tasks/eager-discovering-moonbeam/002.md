---
name: BackfillRequestTracker Implementation
status: done
created: 2026-01-08T21:22:12Z
updated: 2026-01-09T00:00:00Z
depends_on: [001]
conflicts_with: []
---

# Task: BackfillRequestTracker Implementation

## Description
Implement the BackfillRequestTracker struct to make the tests from Task 001 pass (GREEN phase).

## Acceptance Criteria
- [x] BackfillRequestTracker struct with `pending: RwLock<HashMap<Uuid, PendingRequest>>`
- [x] PendingRequest struct with `node_id`, `attempt_ids`, `requested_at` fields
- [x] `new()` constructor
- [x] `track()` method to record request_id -> (node_id, attempt_ids)
- [x] `complete()` method to get and remove attempt IDs for a request
- [x] `clear_node()` method to remove all requests for a node
- [x] `cleanup_stale()` method to remove requests older than timeout

## Technical Details
- Location: `crates/remote/src/nodes/backfill.rs`
- Use `tokio::sync::RwLock` for thread-safe access
- All methods are async
- `complete()` returns `Option<Vec<Uuid>>` - None if not found
- `clear_node()` and `cleanup_stale()` return `Vec<Uuid>` of affected attempt IDs

## Dependencies
- [x] Task 001 - Tests must exist first (TDD)

## Effort Estimate
- Size: S
- Hours: 1

## Definition of Done
- [x] BackfillRequestTracker struct implemented (~80 lines)
- [x] All 3 tests from Task 001 pass
- [x] `cargo test -p remote -- test_tracker` passes
- [x] `cargo clippy -p remote -- -D warnings` passes
