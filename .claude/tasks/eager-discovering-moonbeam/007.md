---
name: Wire Tracker Through WebSocket Handler
status: done
created: 2026-01-08T21:22:12Z
updated: 2026-01-09T06:15:00Z
depends_on: [006]
conflicts_with: [006]
---

# Task: Wire Tracker Through WebSocket Handler

## Description
Pass the tracker from AppState through the WebSocket handler chain so it's available for backfill response handling.

## Acceptance Criteria
- [x] Update `mod.rs` to get tracker from state and pass to `handle()`
- [x] Update `session.rs` `handle()` signature to accept `tracker: Arc<BackfillRequestTracker>`
- [x] Pass tracker through to `handle_backfill_response()` when processing messages

## Technical Details
- Location: `crates/remote/src/nodes/ws/mod.rs` and `session.rs`
- In mod.rs: get tracker via `state.backfill_tracker()`
- Add import for BackfillRequestTracker in both files

## Implementation Notes
The implementation approach differs slightly from the original plan:
- Instead of passing tracker directly from mod.rs, the BackfillService is passed and tracker is extracted in session.rs via `backfill.tracker()`
- This achieves the same goal while keeping the service accessible for other operations
- The tracker is extracted at line 178 in session.rs: `let tracker = backfill.tracker();`
- The tracker is passed to `handle_node_message()` at line 204 and flows to `handle_backfill_response()` at line 537

## Dependencies
- [x] Task 006 - handle_backfill_response must accept tracker

## Effort Estimate
- Size: S
- Hours: 0.5

## Definition of Done
- [x] mod.rs passes tracker to handle() (via BackfillService)
- [x] session.rs handle() accepts tracker (extracts from BackfillService)
- [x] Tracker flows through to response handler
- [x] `cargo check -p remote` passes

## Verification
- All 8 backfill tests pass
- Clippy passes with no warnings
- Frontend loads without critical errors
